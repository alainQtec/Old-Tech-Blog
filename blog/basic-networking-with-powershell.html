<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title> Basic Networking with PowerShell | @alainQtec</title><meta http-equip="X-UA-Compatible" content="IE=edge" /><meta name="viewport" content="width=device-width, initial-scale=1" /><meta name="description" content="Get started on how to use powershell with networking- Basic Networking with PowerShell"><meta name="keywords" content="Basic Networking with PowerShell, alainQtec, it-ops,PowerShell, Networking" /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /><meta content="" property="fb:app_id" /><meta content="alainQtec" property="og:site_name" /><meta content="Basic Networking with PowerShell" property="og:title" /><meta content="article" property="og:type" /><meta content="Get started on how to use powershell with networking" property="og:description" /><meta content="https://www.alainqtec.com/blog/basic-networking-with-powershell" property="og:url" /><meta content="2021-08-30T06:57:23+02:00" property="article:published_time" /><meta content="https://www.alainqtec.com/about/" property="article:author" /><meta content="https://www.alainqtec.com/assets/img/posts/powershell.jpeg" property="og:image" /><meta content="it-ops" property="article:section" /><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@" /><meta name="twitter:title" content="Basic Networking with PowerShell" /><meta name="twitter:url" content="https://www.alainqtec.com/blog/basic-networking-with-powershell" /><meta name="twitter:description" content="Get started on how to use powershell with networking" /> <!--====================== CSS ======================--><link rel="stylesheet" href="https://www.alainqtec.com/assets/css/main.css" /><link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css'><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css'><link rel="stylesheet" href="https://www.alainqtec.com/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /><link rel="stylesheet" href="https://www.alainqtec.com/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /><link rel="stylesheet" href="https://www.alainqtec.com/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /><link rel="stylesheet" href="https://www.alainqtec.com/assets/bower_components/icono/dist/icono.min.css" /><link rel="stylesheet" href="https://i.icomoon.io/public/temp/d3a8c9b913/UntitledProject/style.css"><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.css'><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.11.0/themes/prism-okaidia.min.css"><link rel="stylesheet" href="https://www.alainqtec.com/assets/css/atomic-bulldog-grid.css"><link rel="stylesheet" href="https://www.alainqtec.com/assets/css/footer.css"> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.11.0/prism.min.js"></script><link rel="shortcut icon" href="https://www.alainqtec.com/assets/img/favicon.png" type="image/x-icon"><link rel="icon" href="https://www.alainqtec.com/assets/img/favicon.png" type="image/x-icon"> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous"></script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script> <script src="https://www.alainqtec.com/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://www.alainqtec.com/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://www.alainqtec.com/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://www.alainqtec.com/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://www.alainqtec.com/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://www.alainqtec.com/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://www.alainqtec.com/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src='https://cdnjs.cloudflare.com/ajax/libs/smooth-scrollbar/8.3.1/smooth-scrollbar.js'></script> <script src='https://cdnjs.cloudflare.com/ajax/libs/smooth-scrollbar/8.3.1/plugins/overscroll.js'></script> <script> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-115907213-1']); _gaq.push(['_trackPageview']); (function () { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="alainherve" data-description="Support Alain on Buy me a coffee!" data-message="" data-color="hsla(251, 82%, 72%, 0.522)" data-position="right" data-x_margin="10" data-y_margin="10"></script> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]><html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--><html class="no-js"> <!--<![endif]--><body><main class="main" id="scroll-animate"><nav class="navbar sticky-top" id="navbar"> <a class="blognavbrand" href="https://www.alainqtec.com"><span>alain</span><span>Q</span><span>tec</span></a><ul><li><a class="nav-link scrollto" href="https://www.alainqtec.com/blog">Home</a><li class="dropdown"><a class="nav-link scrollto" href="https://www.alainqtec.com/about"><span>About</span> <i class="bi bi-chevron-down"></i></a><ul><li><a href="https://www.alainqtec.com/about/">This blog</a><li class="dropdown"> <a href="https://www.alainqtec.com/blog/authors/"><span>Authors</span><i class="uil uil-angle-right nav-chevron"></i></a><ul><li><a href="https://www.alainqtec.com/blog/authors/alain/">Alain</a><li><a href="https://www.alainqtec.com/blog/authors/testauthor/">Test Author</a></ul></ul><li class="dropdown"> <a class="nav-link scrollto" href="https://www.alainqtec.com/blog/categories/"> <span>Categories</span> <i class="uil uil-angle-right nav-chevron"></i></a><ul><li> <a href="https://www.alainqtec.com/blog/categories/windows/"><i class="uil uil-microsoft nav-sublink"> Windows</i></a><li><a href="https://www.alainqtec.com/blog/categories/cloud/"><i class="uil uil-desktop-cloud-alt nav-sublink"> Cloud</i></a><li><a href="https://www.alainqtec.com/blog/categories/it-ops"><i class="uil uil-robot nav-sublink"> IT-Ops</i></a><li><a href="https://www.alainqtec.com/blog/categories/security/"><i class="uil uil-shield nav-sublink"> Security</i></a><li><a href="https://www.alainqtec.com/blog/categories/tools/"><i class="uil uil-package nav-sublink"> Tools</i></a></ul><li><a class="nav-link scrollto" href="https://www.alainqtec.com/gallery"><span>Gallery</span></a><li class="nav_shopicon"> <a class="nav-link scrollto toggle-shop-button" href="https://www.alainqtec.com/shop"> <i class="uil uil-shopping-cart" aria-hidden="true"></i> <span>Shop</span> </a><li class="dropdown"> <a class="nav-link scrollto" href="#"><span>More</span> <i class="uil uil-angle-right nav-chevron"></i></a><ul><li><a href="https://www.alainqtec.com/blog/archive/"> <i class="uil uil-archive-alt nav-sublink"> Archive</i></a><li><a href="#"><i class="uil uil-lightbulb-alt nav-sublink"> Topic Suggestion</i></a><li><a href="#"><i class="uil uil-gift nav-sublink"> Giveaways</i></a></ul><li class="dropdown"><a class="nav-link scrollto" href="https://www.alainqtec.com/forum/profile/"> <span>Account</span> <i class="bi bi-chevron-down"></i></a><ul><li><a href="https://www.alainqtec.com/forum/profile/"><i class="uil uil-user nav-sublink"> Profile</i></a><li><a href="https://www.alainqtec.com/forum/register/"><i class="uil uil-user-plus nav-sublink"> Register</i></a><li><a href="https://www.alainqtec.com/forum/login/"><i class="uil uil-signout nav-sublink"> Logout</i></a></ul></ul><div class="nav_searchicon"> <a class="nav-link toggle-search-button" href="#navbar"> <i class="uil uil-search search-icon" aria-hidden="true"></i>Search </a></div><div class="uil uil-apps mobile-nav-toggle"></div></nav><div class="search-form-container"> <form role="form" class="search-form"> <fieldset class="search-form__fieldset"><div class="sr_card"><div id="search-container" class="form-group col-lg-8 offset-md-2"> <input class="search-form__field form-control input-lg" type="input" id="search-input" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"></div></div></fieldset> </form><div id="filter-records"></div><div class="sr_results-container" id="results-container"> <script src="https://www.alainqtec.com/assets/js/search.js" type="text/javascript"></script></div><div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i></div></div><div class="mobile__nvmenu sticky-top"><div class="mmcontainer"><div class="burger-container"><div id="burger"><div class="bar topBar"></div><div class="bar btmBar"></div></div></div><ul class="menu"><li class="menu-item"><a class="menu-link uil uil-estate" href="https://www.alainqtec.com/blog"> Home</a><li class="menu-item"><a class="menu-link uil uil-info-circle" href="https://www.alainqtec.com/about"> About</a><li class="menu-item"><a class="menu-link uil uil-parcel" href="https://www.alainqtec.com/blog/categories/"> Categories</a><li class="menu-item"><a class="menu-link uil uil-images" href="https://www.alainqtec.com/gallery"> Gallery</a><li class="menu-item"><a class="menu-link uil uil-shopping-bag" href="https://www.alainqtec.com/shop"> Shop</a><li class="menu-item"><a class="menu-link uil uil-ellipsis-h" href="#"> More</a><li class="menu-item"><a class="menu-link uil uil-user" href="https://www.alainqtec.com/forum/profile/"> Account</a></ul></div></div><script> (function () { var burger = document.querySelector('.burger-container'), header = document.querySelector('.mmcontainer'); burger.onclick = function () { header.classList.toggle('menu-opened'); } }()); </script><div class="content"><div class="top blog-card"><div class="blog-card__background" style="--bg-img: url('https://www.alainqtec.com/assets/img/posts/powershell.jpeg'); background: url('https://www.alainqtec.com/assets/img/posts/powershell.jpeg') center/cover no-repeat;"><div class="card__background--layer"><div class="blog-card__head"> <span class="date__box"> <span class="date__day"><time datetime="2021-08-30 06:57:23 +0200" itemprop="datePublished">30</time></span> <span class="date__month"><time datetime="2021-08-30 06:57:23 +0200" itemprop="datePublished">Aug</time></span> </span></div></div></div></div><article class="blog_article-card" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-content-wrap"><div class="has-col-all"><div class="divx--item"><h2 class="blog-post_title">Basic Networking with PowerShell</h2></div></div><div class="blog-card__info"><p> <a href="https://www.alainqtec.com/blog/authors/alain" class="icon-link mr-3"><i class="uil uil-edit"></i><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="https://www.alainqtec.com/blog/authors/alain">alain</a></span></span> </a> &nbsp<a href="#" class="icon-link"><i class="uil uil-comments-alt"></i>&nbsp&nbsp150</a></p><p>Get started on how to use powershell with networking</p><div class="post-categories"> Category : <a href="/blog/categories/it-ops">it-ops</a></div></div><div class="blog_post_content"> <!--StartFragment--><p><a href="https://docs.microsoft.com/en-us/powershell/">PowerShell</a> together with networking are becoming more and more important. I created this little cheat sheet so it becomes easy for people to get started.</p><h2 id="basic-networking-powershell-cmdlets">Basic Networking PowerShell cmdlets</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/Get-NetIPConfiguration-1024x569.png" alt="Get-NetIPConfiguration" /></p><p>Get the IP Configuration (ipconfig with PowerShell)</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetIPConfiguration</span></code></pre></figure><p>List all Network Adapters</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapter</span></code></pre></figure><p>Get a spesific network adapter by name</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapter</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="o">*</span><span class="nx">Ethernet</span><span class="o">*</span></code></pre></figure><p>Get more information VLAN ID, Speed, Connection status</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapter</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">Status</span><span class="p">,</span><span class="w"> </span><span class="nx">Linkspeed</span><span class="p">,</span><span class="w"> </span><span class="nx">VlanID</span></code></pre></figure><p>Get driver information</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapter</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">DriverName</span><span class="p">,</span><span class="w"> </span><span class="nx">DriverVersion</span><span class="p">,</span><span class="w"> </span><span class="nx">DriverInformation</span><span class="p">,</span><span class="w"> </span><span class="nx">DriverFileName</span></code></pre></figure><p>Get adapter hardware information. This can be really usefull when you need to know the PCI slot of the NIC.</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapterHardwareInfo</span></code></pre></figure><p>Disable and Enable a Network Adapter</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Disable-NetAdapter</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"Wireless Network Connection"</span><span class="w">
</span><span class="n">Enable-NetAdapter</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"Wireless Network Connection"</span></code></pre></figure><p>Rename a Network Adapter</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Rename-NetAdapter</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"Wireless Network Connection"</span><span class="w"> </span><span class="nt">-NewName</span><span class="w"> </span><span class="s2">"Wireless"</span></code></pre></figure><h2 id="ip-configuration-using-powershell">IP Configuration using PowerShell</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/Get-NetIPAddress-1024x420.png" alt="PowerShell Networking Get-NetIPAddress" /></p><p>Get IP and DNS address information</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapter</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"Local Area Connection"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Get-NetIPAddress</span></code></pre></figure><p>Get IP address only</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="p">(</span><span class="n">Get-NetAdapter</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"Local Area Connection"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Get-NetIPAddress</span><span class="p">)</span><span class="o">.</span><span class="nf">IPv4Address</span></code></pre></figure><p>Get DNS Server Address information</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapter</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"Local Area Connection"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Get-DnsClientServerAddress</span></code></pre></figure><p>Set IP Address</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">New-NetIPAddress</span><span class="w"> </span><span class="nt">-InterfaceAlias</span><span class="w"> </span><span class="s2">"Wireless"</span><span class="w"> </span><span class="nt">-IPv4Address</span><span class="w"> </span><span class="nx">10.0.1.95</span><span class="w"> </span><span class="nt">-PrefixLength</span><span class="w"> </span><span class="s2">"24"</span><span class="w"> </span><span class="nt">-DefaultGateway</span><span class="w"> </span><span class="nx">10.0.1.1</span></code></pre></figure><p>or if you want to change a existing IP Address</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Set-NetIPAddress</span><span class="w"> </span><span class="nt">-InterfaceAlias</span><span class="w"> </span><span class="s2">"Wireless"</span><span class="w"> </span><span class="nt">-IPv4Address</span><span class="w"> </span><span class="nx">192.168.12.25</span><span class="w"> </span><span class="nt">-PrefixLength</span><span class="w"> </span><span class="s2">"24"</span></code></pre></figure><p>Remove IP Address</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapter</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"Wireless"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Remove-NetIPAddress</span></code></pre></figure><p>Set DNS Server</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Set-DnsClientServerAddress</span><span class="w"> </span><span class="nt">-InterfaceAlias</span><span class="w"> </span><span class="s2">"Wireless"</span><span class="w"> </span><span class="nt">-ServerAddresses</span><span class="w"> </span><span class="s2">"10.10.20.1"</span><span class="p">,</span><span class="s2">"10.10.20.2"</span></code></pre></figure><p>Set interface to DHCP</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Set-NetIPInterface</span><span class="w"> </span><span class="nt">-InterfaceAlias</span><span class="w"> </span><span class="s2">"Wireless"</span><span class="w"> </span><span class="nt">-Dhcp</span><span class="w"> </span><span class="nx">Enabled</span></code></pre></figure><p>Clear DNS Cache with PowerShell</p><p>You can also manage your DNS cache with PowerShell.</p><p>List DNS Cache:</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-DnsClientCache</span></code></pre></figure><p>Clear DNS Cache</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Clear-DnsClientCache</span></code></pre></figure><h2 id="ping-with-powershell">Ping with PowerShell</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/Test-NetConnection-Ping-1024x599.png" alt="PowerShell Networking Test-NetConnection Ping" /></p><p>How to Ping with PowerShell. For a simple ping command with PowerShell, you can use the Test-Connection cmdlet:</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Test-Connection</span><span class="w"> </span><span class="nx">alainqtec.com</span></code></pre></figure><p>There is an advanced way to test connection using PowerShell</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Test-NetConnection</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="nx">www.alainqtec.com</span></code></pre></figure><p>Get some more details from the Test-NetConnection</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Test-NetConnection</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="nx">www.alainqtec.com</span><span class="w"> </span><span class="nt">-InformationLevel</span><span class="w"> </span><span class="nx">Detailed</span></code></pre></figure><p>Ping multiple IP using PowerShell</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="mi">1</span><span class="o">..</span><span class="mi">99</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Test-NetConnection</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="nx">x.x.x.</span><span class="bp">$_</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">FT</span><span class="w"> </span><span class="nt">-AutoSize</span></code></pre></figure><h2 id="tracert">Tracert</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/PowerShell-Tracert-1024x425.png" alt="PowerShell Tracert" /></p><p>Tracert with PowerShell</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Test-NetConnection</span><span class="w"> </span><span class="nx">www.thomasmaurer.ch</span><span class="w"> </span><span class="err">–</span><span class="nx">TraceRoute</span></code></pre></figure><h2 id="portscan-with-powershell">Portscan with PowerShell</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/PowerShell-Portscan-1024x505.png" alt="PowerShell Portscan" /></p><p>Use PowerShell to check for open port</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Test-NetConnection</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="nx">www.thomasmaurer.ch</span><span class="w"> </span><span class="nt">-Port</span><span class="w"> </span><span class="nx">80</span><span class="w">
</span><span class="n">Test-NetConnection</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="nx">www.thomasmaurer.ch</span><span class="w"> </span><span class="nt">-CommonTCPPort</span><span class="w"> </span><span class="nx">HTTP</span></code></pre></figure><h2 id="nslookup-in-powershell">NSlookup in PowerShell</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/PowerShell-NSlookup-1024x352.png" alt="PowerShell Networking NSlookup" /></p><p>NSlookup using PowerShell:</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Resolve-DnsName</span><span class="w"> </span><span class="nx">www.thomasmaurer.ch</span><span class="w">
</span><span class="n">Resolve-DnsName</span><span class="w"> </span><span class="nx">www.thomasmaurer.ch</span><span class="w"> </span><span class="nt">-Type</span><span class="w"> </span><span class="nx">MX</span><span class="w"> </span><span class="nt">-Server</span><span class="w"> </span><span class="nx">8.8.8.8</span></code></pre></figure><h2 id="route-in-powershell">Route in PowerShell</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/PowerShell-Route-1024x448.png" alt="PowerShell Networking Route" /></p><p>How to replace Route command with PowerShell</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetRoute</span><span class="w"> </span><span class="nt">-Protocol</span><span class="w"> </span><span class="nx">Local</span><span class="w"> </span><span class="nt">-DestinationPrefix</span><span class="w"> </span><span class="nx">192.168</span><span class="o">*</span><span class="w">
</span><span class="n">Get-NetRoute</span><span class="w"> </span><span class="nt">-InterfaceAlias</span><span class="w"> </span><span class="nx">Wi-Fi</span><span class="w">
 
</span><span class="n">New-NetRoute</span><span class="w"> </span><span class="err">–</span><span class="nx">DestinationPrefix</span><span class="w"> </span><span class="s2">"10.0.0.0/24"</span><span class="w"> </span><span class="err">–</span><span class="nx">InterfaceAlias</span><span class="w"> </span><span class="s2">"Ethernet"</span><span class="w"> </span><span class="err">–</span><span class="nx">NextHop</span><span class="w"> </span><span class="nx">192.168.192.1</span></code></pre></figure><h2 id="netstat-in-powershell">NETSTAT in PowerShell</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/PowerShell-Netstat-1024x448.png" alt="PowerShell Networking Netstat" /></p><p>How to replace NETSTAT with PowerShell</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetTCPConnection</span><span class="w">
</span><span class="nx">Get-NetTCPConnection</span><span class="w"> </span><span class="err">–</span><span class="nx">State</span><span class="w"> </span><span class="nx">Established</span></code></pre></figure><h2 id="nic-teaming-powershell-commands">NIC Teaming PowerShell commands</h2><p>Create a new NIC Teaming (Network Adapter Team)</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">New-NetLbfoTeam</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">NICTEAM01</span><span class="w"> </span><span class="nt">-TeamMembers</span><span class="w"> </span><span class="nx">Ethernet</span><span class="p">,</span><span class="w"> </span><span class="nx">Ethernet2</span><span class="w"> </span><span class="nt">-TeamingMode</span><span class="w"> </span><span class="nx">SwitchIndependent</span><span class="w"> </span><span class="nt">-TeamNicName</span><span class="w"> </span><span class="nx">NICTEAM01</span><span class="w"> </span><span class="nt">-LoadBalancingAlgorithm</span><span class="w"> </span><span class="nx">Dynamic</span></code></pre></figure><h2 id="smb-related-powershell-commands">SMB Related PowerShell commands</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/SMB-PowerShell-SMB-Client-Configuration-1024x521.png" alt="SMB PowerShell SMB Client Configuration" /></p><p>Get SMB Client Configuration</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-SmbClientConfiguration</span></code></pre></figure><p>Get SMB Connections</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-SmbConnection</span></code></pre></figure><p>Get SMB Mutlichannel Connections</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-SmbMutlichannelConnection</span></code></pre></figure><p>Get SMB open files</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-SmbOpenFile</span></code></pre></figure><p>Get SMB Direct (RDMA) adapters</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapterRdma</span></code></pre></figure><h2 id="hyper-v-networking-cmdlets">Hyper-V Networking cmdlets</h2><p><img src="https://www.thomasmaurer.ch/wp-content/uploads/2016/02/Hyper-V-PowerShell-Get-VMNetwork-Adapter-1024x215.png" alt="Hyper-V PowerShell Get-VMNetwork Adapter" /></p><p>Get and set Network Adapter VMQ settings</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-NetAdapterVmq</span><span class="w">
</span><span class="c"># Disable VMQ</span><span class="w">
</span><span class="n">Set-NetAdapterVmq</span><span class="w"> </span><span class="nt">-Enabled</span><span class="w"> </span><span class="bp">$false</span><span class="w">
</span><span class="c"># Enable VMQ</span><span class="w">
</span><span class="n">Set-NetAdapterVmq</span><span class="w"> </span><span class="nt">-Enabled</span><span class="w"> </span><span class="bp">$true</span></code></pre></figure><p>Get VM Network Adapter</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">Get-VMNetworkAdapter</span><span class="w"> </span><span class="nt">-VMName</span><span class="w"> </span><span class="nx">Server01</span></code></pre></figure><p>Get VM Network Adapter IP Addresses</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="p">(</span><span class="n">Get-VMNetworkAdapter</span><span class="w"> </span><span class="nt">-VMName</span><span class="w"> </span><span class="nx">NanoConHost01</span><span class="p">)</span><span class="o">.</span><span class="nf">IPAddresses</span></code></pre></figure><p>Get VM Network Adapter Mac Addresses</p><figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="p">(</span><span class="n">Get-VMNetworkAdapter</span><span class="w"> </span><span class="nt">-VMName</span><span class="w"> </span><span class="nx">NanoConHost01</span><span class="p">)</span><span class="o">.</span><span class="nf">MacAddress</span></code></pre></figure><p>I hope you enjoyed it and the post was helpful, if you think something important is missing, please add it in the comments.</p><!--EndFragment--></div></div></article><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6633984128817867" crossorigin="anonymous"></script></div><script id="dsq-count-scr" src="//alainqtec.disqus.com/count.js" async></script><div id="fb-root"></div><script> (function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><div id="share-btn" class="share__btn"><ul class="share-menu"><li class="share top"> <i class="fa fa-share-alt"></i><ul class="submenu"><li><a class="fb-share-button" data-href="https://www.alainqtec.com/blog/basic-networking-with-powershell" data-size="large" data-layout="button"><i class="fa fa-facebook"></i></a><li><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" data-size="large" data-show-count="false"><i class="fa fa-twitter"></i></a><li><a href="#" class="googlePlus"><i class="fa fa-google-plus"></i></a><li><a href="#" class="instagram"><i class="fa fa-instagram"></i></a></ul></ul></div></div><div class="col"><h1>Services</h1><ul><li><a href="#contact" class="footer__link">Web devlopment</a><li><a href="#contact" class="footer__link">UI design</a><li><a href="#contact" class="footer__link">Brand design</a><li><a href="#contact" class="footer__link">IT tech Support</a></ul></div><div class="col"><h1>Blog</h1><ul><li><a href="" class="footer__link">Webmail</a><li><a href="" class="footer__link">WHOIS lookup</a><li><a href="" class="footer__link">Web templates</a><li><a href="" class="footer__link">Email templates</a></ul></div><div class="col"><h1>Feedback</h1><ul><li><a href="" class="footer__link">Web chat</a><li><a class="footer__feedbackm" href="#">Please send us your ideas, bug reports, suggestions! Any feedback would be appreciated.</a></ul></div><div class="col social footer__socials"><h1>Social</h1><ul><li> <a href="https://web.facebook.com/alainQtec" class="footer__social" target="_blank"> <i class="uil uil-facebook"></i> </a><li> <a href="https://www.instagram.com/alainQtec" class="footer__social" target="_blank"> <i class="uil uil-instagram"></i> </a><li> <a href="https://twitter.com/alainQtec" class="footer__social" target="_blank"> <i class="uil uil-twitter-alt"></i> </a><li> <a href="https://reddit.com/r/alainQtec" target="_blank" class="footer__social" target="_blank"> <i class="uil uil-reddit-alien-alt"></i> </a><li> <a href="https://www.youtube.com/channel/UCDVYFgx4pJekehwMUuXOyNA" class="footer__social" target="_blank"> <i class="uil uil-youtube"></i> </a><li> <a href="https://discord.com/" class="footer__social" target="_blank"> <i class="uil uil-discord"></i> </a><li> <a href="https://wa.me/250784703243" class="footer__social" target="_blank"> <i class="uil uil-whatsapp"></i> </a></ul></div><div class="clearfix"></div></div><br><hr class="foo_hr"><p class="footer__copy">&#169; alainQtec 2021, All rights reserved - <a class="footer__legal" href="https://www.alainqtec.com/terms-of-service" target="_blank" rel="noopener noreferrer">Terms of Service</a> - <a class="footer__legal" href="https://www.alainqtec.com/privacy-policy" target="_blank" rel="noopener noreferrer">Privacy Policy</a></p><p><a class="back-to-top" href="#">Back &#x2191; to top</a></p></div></div></footer><!--===== SCROLL REVEAL =====--> <script src="https://unpkg.com/scrollreveal"></script> <!--==================== MAIN JS ====================--> <script src="https://www.alainqtec.com/assets/js/mode-switcher.js"></script><div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div><script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script>
