---
extra_scss: ""
---

<!-- forestryio: ignore; forestryio: admin -->
<!-- This is just a ui to scare people away // since forestry won't allow unknown account to view the site dashboard -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="robots" content="noindex" />
  <title>alainQtec authv2</title>
  <meta name="description" content="Admin CMS page for alainqtec.com" />
  <meta name="author" content="Alain Herve" />
  <meta name="HandheldFriendly" content="true" />
  <meta name="MobileOptimized" content="320" />
  <!-- Use maximum-scale and user-scalable at your own risk. It disables pinch/zoom. Think about usability/accessibility before including.-->
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">

  <!-- Fort awesome icon kit -->
  <script src="https://use.fortawesome.com/b6f38602.js"></script>
  {%- include head/favicon.html -%}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <!-- <link rel="stylesheet"
    href="https://github.com/alainQtec/tech-blog/blob/5b777e40b282b635f226dcdfad2de3e84ae857cf/assets/css/admin.css"> -->
  <!-- for netlify cms: <link href="https://unpkg.com/netlify-cms/dist/cms.css" rel="stylesheet" /> -->
  <!-- <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> -->
  <style>
    @charset "UTF-8";

    *,
    *:before,
    *:after {
      transition: all 0.5s cubic-bezier(0.5, 0, 0.5, 1);
      transition-property: transform, opacity, background-color, border-color;
      transition-delay: 0s;
    }

    #app:after {
      content: attr(data-state);
      position: absolute;
      top: 100%;
      margin-top: 1rem;
      font-size: 5vmin;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 2vmin 5vmin;
      border-radius: 5vmin;
    }

    [data-show] {
      opacity: 0;
    }

    [data-show][data-active] {
      opacity: 1;
    }

    [data-state~=idle] {
      -webkit-animation: reset 1s cubic-bezier(0.5, 0, 0.5, 1) both;
      animation: reset 1s cubic-bezier(0.5, 0, 0.5, 1) both;
    }

    [data-state~=idle] .ui-icon {
      --bg: #E3E6F9;
      --color: var(--color-primary);
    }

    [data-state~=idle] .ui-password:before {
      background-color: var(--color-primary);
      transform: translateX(-100%);
    }

    [data-state~=idle] .ui-password:focus-within:before {
      transform: none;
    }

    [data-state~=validating] .ui-icon {
      --bg: #E3E6F9;
      --color: var(--color-primary);
    }

    [data-state~=validating] .ui-password:before {
      transform-origin: left center;
      background-color: var(--color-primary);
      -webkit-animation: password-validating 1s infinite;
      animation: password-validating 1s infinite;
    }

    [data-state~=validating] .ui-submit {
      opacity: 0.5;
      pointer-events: none;
    }

    [data-state~="idle.error"] .ui-icon {
      background-color: #FAD0D8;
      --color: var(--color-error);
      -webkit-animation: icon-error 1s cubic-bezier(0.5, 0, 0.5, 1) both;
      animation: icon-error 1s cubic-bezier(0.5, 0, 0.5, 1) both;
    }

    [data-state~="idle.error"] .ui-password:before {
      -webkit-animation: slide-right 0.5s cubic-bezier(0.5, 0, 0.5, 1) both;
      animation: slide-right 0.5s cubic-bezier(0.5, 0, 0.5, 1) both;
      background-color: #E2294E;
    }

    [data-state~=success] .ui-icon {
      --bg: var(--color-success);
      --color: var(--color-success);
    }

    [data-state~=success] .ui-icon:before {
      -webkit-animation: icon-bg-success 0.5s ease-out both;
      animation: icon-bg-success 0.5s ease-out both;
    }

    [data-state~=success] .ui-password:before {
      -webkit-animation: slide-right 0.5s cubic-bezier(0.5, 0, 0.5, 1) both;
      animation: slide-right 0.5s cubic-bezier(0.5, 0, 0.5, 1) both;
      background-color: var(--color-success);
    }

    [data-state]:not([data-state~=idle]) .ui-password-input {
      pointer-events: none;
      cursor: not-allowed;
      opacity: 0.5;
    }

    [data-state]:not([data-state~=idle]) .ui-submit {
      opacity: 0.5;
    }

    @-webkit-keyframes password-validating {
      from {
        transform: translateX(-100%) scaleX(0.5);
      }

      to {
        transform: translateX(100%) scaleX(0.5);
      }
    }

    @keyframes password-validating {
      from {
        transform: translateX(-100%) scaleX(0.5);
      }

      to {
        transform: translateX(100%) scaleX(0.5);
      }
    }

    @-webkit-keyframes slide-right {
      from {
        transform: translateX(-100%);
      }

      to {
        transform: none;
      }
    }

    @keyframes slide-right {
      from {
        transform: translateX(-100%);
      }

      to {
        transform: none;
      }
    }

    @-webkit-keyframes icon-error {

      from,
      85%,
      to {
        transform: none;
      }

      20%,
      50% {
        transform-origin: right center;
        transform: translateX(-30%) scaleX(1.1);
      }

      35%,
      65% {
        transform-origin: left center;
        transform: translateX(30%) scaleX(1.1);
      }
    }

    @keyframes icon-error {

      from,
      85%,
      to {
        transform: none;
      }

      20%,
      50% {
        transform-origin: right center;
        transform: translateX(-30%) scaleX(1.1);
      }

      35%,
      65% {
        transform-origin: left center;
        transform: translateX(30%) scaleX(1.1);
      }
    }

    @-webkit-keyframes icon-bg-success {
      from {
        transform: scale(1);
        opacity: 0.5;
      }

      to {
        transform: scale(4);
        opacity: 0;
      }
    }

    @keyframes icon-bg-success {
      from {
        transform: scale(1);
        opacity: 0.5;
      }

      to {
        transform: scale(4);
        opacity: 0;
      }
    }

    .ui-modal {
      --color-primary: #5A52FF;
      --color-error: #E0294C;
      --color-success: #0DBE65;
      background-color: #fff;
      padding: 2rem 4rem;
      border-radius: 0.5rem;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.1);
    }

    .ui-icon {
      height: 3rem;
      width: 3rem;
      border-radius: 50%;
      margin-bottom: 1rem;
    }

    .ui-icon:before {
      content: "";
      position: absolute;
      display: block;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: inherit;
      background: var(--bg);
      will-change: transform;
    }

    .ui-icon>.ui-lock {
      height: 100%;
      width: 100%;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .ui-icon>.ui-lock:before,
    .ui-icon>.ui-lock:after {
      content: "";
      position: absolute;
    }

    .ui-icon>.ui-lock:after {
      background-color: var(--color);
      height: 25%;
      width: 45%;
      transform: translateY(50%);
      border-radius: 2px;
    }

    .ui-icon>.ui-lock:before {
      width: 30%;
      height: 50%;
      border-radius: 1rem;
      border: 4px solid var(--color);
    }

    .ui-title {
      font-size: 1rem;
      line-height: 2rem;
    }

    .ui-subtitle {
      font-size: 0.75rem;
      height: 1rem;
      margin-bottom: 1rem;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #9A9CA2;
    }

    .ui-subtitle>span {
      line-height: 1rem;
      position: absolute;
      white-space: nowrap;
    }

    .ui-subtitle>span.ui-error {
      font-weight: bold;
      color: var(--color-error);
    }

    .ui-password {
      -webkit-appearance: none;
      appearance: none;
      -moz-appearance: none;
      background: none;
      border: none;
      padding-bottom: 2px;
      margin-bottom: 2rem;
      overflow: hidden;
    }

    .ui-password:before,
    .ui-password:after {
      content: "";
      position: absolute;
      height: 2px;
      width: 100%;
      bottom: 0;
      left: 0;
      z-index: 1;
    }

    .ui-password:after {
      background-color: #E8E9F0;
      z-index: 0;
    }

    .ui-password-input {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      background: none;
      border: none;
      height: 2rem;
      width: 15rem;
    }

    .ui-password-input:focus {
      outline: none;
    }

    .ui-submit {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      padding: 0 1.5rem;
      height: 2rem;
      border-radius: 0.5rem;
      font-size: 0.75rem;
      color: white;
      background-color: var(--color-primary);
    }

    .ui-submit:active {
      transform: scale(0.9);
      transition-duration: 0.2s;
    }

    .ui-submit:focus {
      outline: none;
    }

    .ui-link {
      color: var(--color-primary);
      text-decoration: none;
    }

    .ui-reset {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      background: none;
      border: none;
      position: absolute;
      top: 0;
      right: 0;
      padding: 1rem;
    }

    .ui-reset:before {
      content: "ï½˜";
      color: #AAAFBD;
      font-weight: bold;
      font-size: 1.5rem;
    }

    .ui-reset:focus {
      outline: none;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #CED0E0;
    }

    html,
    body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      font-size: 18px;
    }

    *,
    *:before,
    *:after {
      box-sizing: border-box;
      position: relative;
    }
  </style>
</head>

<body>
  <!-- <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/cms.js"></script> -->
  <!-- <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script> -->
  <form id="app" class="ui-modal" data-state="idle" autocomplete="off">
    <div class="ui-icon">
      <div class="ui-lock"></div>
    </div>
    <div class="ui-title">Admin CMS</div>
    <div class="ui-subtitle">
      <span data-show="idle">
        Please enter your password to continue.
      </span>
      <span data-show="validating">
        Validating...
      </span>
      <span data-show="error" class="ui-error">
        Invalid password
      </span>
      <span data-show="success">
      </span>
      <!-- TODO: div#app should always be hidden untill  span.data-show="success" -->
    </div>
    <div class="ui-password">
      <input type="password" name="" id="" class="ui-password-input" placeholder="Enter your passkey to continue." />
    </div>
    <button class="ui-submit">Submit</button>
    <button class="ui-reset" type="button" title="Reset"></button>
  </form>
  <script src='https://unpkg.com/xstate@next/dist/xstate.js'></script>
  <script>
    console.clear();
    const elApp = document.querySelector("#app");
    const elButton = document.querySelector(".ui-submit");
    const elPassword = document.querySelector(".ui-password-input");
    const elReset = document.querySelector(".ui-reset");

    const context = {
      password: ""
    };


    const actions = {
      assignPassword: XState.assign({
        password: (_, event) => event.value
      }),

      validatePassword: ctx => {
        setTimeout(() => {
          // Just for show. Not my real forestry password & not secure ðŸš§.
          if (ctx.password === "9874_forestry_cms") {
            send("VALID");
            // $.getScript("{{site.url}}{{site.baseurl}}/assets/js/forestry_login.js");
            var siteId = "mufuojwz6nnomg";
            window.open(("https://app.forestry.io/sites/" + siteId), '_blank').focus();
          } else {
            send("INVALID");
            // todo: add a script to count/log the number of failures
          }
        }, 2000);
      },

      clearPassword: XState.assign({
        password: () => {
          elPassword.value = '';
          return '';
        }
      })
    };



    const passwordMachine = XState.Machine(
      {
        initial: "idle",
        context,
        states: {
          idle: {
            entry: "clearPassword",
            on: {
              SUBMIT: { target: "validating", cond: "passwordEntered" },
              CHANGE: {
                target: "idle",
                actions: "assignPassword",
                internal: true // this prevents onEntry from running again
              }
            },

            initial: 'normal',
            states: {
              normal: {},
              error: {
                after: {
                  2000: "normal"
                }
              }
            }
          },




          validating: {
            onEntry: "validatePassword",
            on: {
              VALID: "success",
              INVALID: "idle.error"
            }
          },


          success: {}
        },

        on: {
          RESET: ".idle"
        }
      },


      {
        actions,
        guards: {
          passwordEntered: ctx => {
            return ctx.password && ctx.password.length;
          }
        }
      });




    let state = passwordMachine.initialState;

    function activate(state) {
      elApp.dataset.state = state.toStrings().join(' ');

      document.querySelectorAll("[data-active]").forEach(el => {
        el.removeAttribute("data-active");
      });

      document.querySelectorAll(`[data-show~="${state.value}"]`).forEach(el => {
        el.setAttribute("data-active", true);
      });
    }

    const interpreter = XState.
      interpret(passwordMachine).
      onTransition(activate).
      start();

    activate(state);

    const { send } = interpreter;

    elButton.addEventListener("click", () => send("SUBMIT"));
    elPassword.addEventListener("input", (e) =>
      send({ type: "CHANGE", value: e.target.value }));

    elApp.addEventListener("submit", e => {
      e.preventDefault();
      send("SUBMIT");
    });
    elReset.addEventListener("click", () => send("RESET"));
  </script>
</body>

</html>